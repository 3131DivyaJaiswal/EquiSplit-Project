{% extends "base.html" %}
{% block content %}
<div class="mx-auto" style="max-width:480px;">
  <div class="card shadow-lg p-4">
    {% if form.errors %}
  <div class="alert alert-danger">{{ form.errors }}</div>
{% endif %}
    <h4 style="color:var(--theme-accent);font-weight:700;" class="mb-3">
        Add Expense to <span style="font-weight:900;">"{{ group.name }}"</span>
    </h4>
    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label for="id_description" class="form-label fw-semibold">Description</label>
        <input type="text" name="description" class="form-control rounded-3" id="id_description" placeholder="e.g. Dinner bill" required>
      </div>
      <div class="mb-3">
        <label for="id_amount" class="form-label fw-semibold">Amount</label>
        <input type="number" step="0.01" name="amount" class="form-control rounded-3" id="id_amount" placeholder="0.00" required>
      </div>
      <div class="mb-3">
        <label for="id_paid_by" class="form-label fw-semibold">Paid By</label>
        <select name="paid_by" class="form-select rounded-3" id="id_paid_by" required>
            {% for member in form.paid_by.field.queryset %}
              <option value="{{ member.id }}">{{ member.username }}</option>
            {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label fw-semibold">Who should split this expense?</label>
        <div class="form-check">
        {% for member in form.participants.field.queryset %}
          
          <label class="form-check-label me-3 btn btn-secondary" for="participant_{{ member.id }}">
            <input class="form-check-input" type="checkbox" name="participants" id="participant_{{ member.id }}" value="{{ member.id }}"
          {% if member in form.participants.value %}checked{% endif %}>
            {{ member.username }}
          </label>
        {% endfor %}
        </div>
        <div class="text-muted small ms-1">Unchecked members will not share this expense.</div>
      </div>
      <button class="btn btn-accent w-100 mt-2">Add Expense</button>
      <a href="{% url 'group_detail' group.id %}" class="btn btn-link d-block mt-2">Cancel</a>
    </form>
  </div>
</div>
{% endblock %}
